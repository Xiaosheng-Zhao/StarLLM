/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/dinov2/layers/swiglu_ffn.py:43: UserWarning: xFormers is available (SwiGLU)
  warnings.warn("xFormers is available (SwiGLU)")
/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/dinov2/layers/attention.py:27: UserWarning: xFormers is available (Attention)
  warnings.warn("xFormers is available (Attention)")
/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/dinov2/layers/block.py:33: UserWarning: xFormers is available (Block)
  warnings.warn("xFormers is available (Block)")
Global seed set to 42
wandb: Currently logged in as: xiaosheng_zhao. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.4
wandb: Run data is saved locally in /scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/outputs/wandb/run-20240716_124958-k1nidkft
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-puddle-34
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xiaosheng_zhao/astroclip-spectrum
wandb: üöÄ View run at https://wandb.ai/xiaosheng_zhao/astroclip-spectrum/runs/k1nidkft
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [9]

  | Name            | Type       | Params
-----------------------------------------------
0 | data_embed      | Linear     | 17.7 K
1 | position_embed  | Embedding  | 614 K 
2 | dropout         | Dropout    | 0     
3 | blocks          | ModuleList | 42.5 M
4 | final_layernorm | LayerNorm  | 1.5 K 
5 | head            | Linear     | 16.9 K
-----------------------------------------------
43.2 M    Trainable params
0         Non-trainable params
43.2 M    Total params
172.711   Total estimated model params size (MB)
Sanity Checking: 0it [00:00, ?it/s]/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 80 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
Sanity Checking:   0%|          | 0/1 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/1 [00:00<?, ?it/s]{'images': tensor([[[[-2.8925e-01,  3.3211e-01,  8.6520e-01,  ...,  1.3024e-02,
           -6.3986e-01,  8.4866e-02],
          [ 8.9233e-01,  4.6873e-01,  8.4246e-01,  ..., -2.9479e-01,
           -3.1371e-01,  2.7039e-01],
          [ 5.5356e-01, -5.0210e-01,  3.9459e-01,  ..., -3.2689e-01,
           -9.2761e-01,  6.7184e-03],
          ...,
          [-2.1798e-01, -1.8435e-01, -3.1332e-01,  ...,  3.1262e-01,
           -4.7249e-01,  3.1243e-01],
          [-5.4615e-02,  1.5843e-01,  9.9417e-01,  ...,  3.3650e-01,
            7.6737e-03, -4.7229e-01],
          [-7.6711e-01, -3.9052e-01,  5.5260e-01,  ...,  1.2136e-01,
            6.4164e-01, -7.1725e-01]],

         [[ 2.8024e-01,  1.9692e-01,  5.8159e-01,  ...,  1.1923e-01,
           -1.2281e-01, -4.8263e-01],
          [ 3.4205e-01, -2.5396e-01,  4.1619e-01,  ...,  3.3475e-01,
            3.6795e-01,  1.1714e-01],
          [-2.6398e-01, -8.5289e-01,  1.4137e-01,  ..., -7.4150e-02,
            1.9942e-01,  3.3203e-01],
          ...,
          [ 5.1184e-01, -1.3450e-01, -9.7652e-01,  ...,  2.2177e-01,
            1.0941e-01, -8.0193e-01],
          [ 4.4050e-02,  4.6756e-01, -2.0258e-01,  ..., -2.7755e-01,
            9.8137e-02,  3.1303e-01],
          [-5.3191e-01, -8.5845e-02, -6.8937e-01,  ..., -6.8303e-02,
           -2.9760e-01,  1.9044e-01]],

         [[-4.8671e-03, -3.3044e-01, -2.8009e-01,  ..., -6.2475e-01,
           -6.7763e-01, -5.8474e-01],
          [-7.5696e-01, -7.3212e-01, -4.1092e-01,  ...,  6.7617e-01,
            8.6333e-01,  4.5476e-01],
          [-7.0315e-01, -4.8886e-01, -6.3038e-02,  ...,  6.1501e-01,
            4.2165e-01,  4.7798e-01],
          ...,
          [-2.2031e-01,  6.0432e-02,  1.9931e-01,  ...,  1.0105e+00,
            3.0507e-01, -3.9551e-01],
          [-8.4421e-02,  5.2465e-01, -3.0159e-02,  ...,  5.4925e-01,
           -4.6679e-01, -6.9557e-01],
          [ 1.8942e-01,  3.8118e-01, -1.0649e-01,  ...,  3.1565e-01,
            1.1515e-01, -6.1417e-01]],

         [[ 5.0734e-01, -5.0916e-01, -1.5252e-01,  ...,  2.4419e-01,
           -4.8245e-01, -2.1617e-01],
          [ 6.5509e-01, -8.1029e-01, -5.7406e-01,  ...,  1.2336e-01,
           -6.3855e-01, -2.2577e-01],
          [ 1.5759e-01, -2.6083e-01,  4.8460e-01,  ..., -4.3530e-03,
           -9.2152e-01, -2.2890e-01],
          ...,
          [ 4.0097e-02, -7.5353e-01,  6.2817e-01,  ..., -1.0431e-01,
            5.3030e-01,  2.7487e-01],
          [ 1.2816e-01, -8.3471e-01, -2.8378e-01,  ..., -1.6734e-01,
           -2.6250e-01,  5.4553e-03],
          [-7.3428e-02,  6.8890e-01,  3.8213e-01,  ..., -1.5899e-01,
            1.1355e-01, -5.3671e-01]],

         [[-5.1966e-01,  5.1059e-01, -2.8883e-01,  ..., -4.6717e-01,
            1.9976e-01,  8.8074e-01],
          [ 2.9947e-01,  1.0458e+00,  2.9850e-01,  ...,  5.3830e-01,
            7.4006e-01, -3.3078e-01],
          [ 4.9108e-01,  1.0380e+00,  6.2396e-02,  ..., -2.4356e-01,
            1.0962e-01, -1.3322e+00],
          ...,
          [ 2.0776e-01,  7.2172e-01,  2.4171e-01,  ..., -2.7029e-01,
           -2.1273e-01, -5.9205e-01],
          [-3.0444e-01,  2.3332e-01,  7.0884e-01,  ..., -2.8844e-01,
            3.0689e-01,  4.6981e-01],
          [-8.2542e-01, -6.9976e-01, -2.1253e-01,  ..., -8.2288e-01,
           -4.5644e-01, -4.3419e-01]]],


        [[[ 7.3283e-02,  6.4644e-01, -1.0915e-01,  ...,  3.9532e-01,
           -5.7228e-02,  9.1667e-02],
          [-5.0966e-02,  3.8481e-01, -3.3482e-01,  ...,  9.0443e-01,
           -5.9503e-01, -3.3239e-01],
          [-2.3219e-01, -5.1200e-01, -5.2472e-01,  ...,  7.8483e-01,
            1.9228e-01,  2.0480e-01],
          ...,
          [ 7.3877e-01,  5.7896e-01, -4.0946e-03,  ..., -6.6008e-01,
           -6.3321e-01, -5.3826e-01],
          [ 2.8703e-01, -6.0663e-02,  5.1027e-01,  ..., -1.3521e-01,
           -3.5409e-02,  1.2642e-01],
          [-3.4350e-01, -4.9551e-02,  4.0299e-01,  ...,  6.2523e-01,
           -1.8067e-01, -4.9028e-03]],

         [[-4.3514e-02,  3.7565e-01,  4.8855e-01,  ..., -3.6076e-02,
            7.1673e-01,  1.0105e+00],
          [ 4.8908e-01,  1.7582e-02,  1.1640e-01,  ..., -3.5882e-01,
            2.3540e-01,  8.5751e-01],
          [ 4.8403e-01, -2.2228e-01,  1.1055e-01,  ...,  9.0426e-01,
           -1.9758e-01,  2.2504e-01],
          ...,
          [-2.4566e-01,  1.9556e-01,  5.1052e-02,  ..., -7.6550e-01,
            4.3728e-01,  1.1072e+00],
          [-5.2112e-01, -9.8765e-02, -9.3718e-02,  ..., -3.7980e-01,
           -5.5220e-01, -1.2719e-01],
          [-3.3810e-01, -2.0130e-01,  9.6111e-01,  ...,  7.1221e-01,
            8.0067e-01,  1.4030e-01]],

         [[ 4.1124e-01,  7.0943e-01,  8.0681e-01,  ...,  1.8986e-01,
            1.1629e-01, -9.8807e-02],
          [-5.1200e-02,  4.4846e-01,  2.7296e-01,  ...,  3.8873e-01,
            4.2141e-01, -6.0072e-02],
          [ 1.8912e-02,  5.6661e-01,  1.5091e-01,  ...,  7.3215e-01,
            1.1957e+00,  9.0106e-02],
          ...,
          [-2.1393e-01,  3.9458e-01, -5.3528e-01,  ...,  6.1465e-01,
            7.5920e-01,  7.8517e-01],
          [-8.4948e-01, -5.8159e-01, -5.1083e-01,  ...,  3.6969e-01,
            4.4521e-01,  1.1952e+00],
          [ 3.1213e-01,  7.1181e-01,  1.5200e-01,  ...,  1.9203e-01,
            1.5654e-01,  8.9943e-01]],

         [[-4.4671e-01, -1.2909e-01, -3.2638e-01,  ...,  3.7385e-01,
           -3.1404e-01,  5.0403e-01],
          [-4.7834e-01,  6.0219e-01,  2.8688e-01,  ..., -1.0769e-01,
           -3.0767e-01,  3.4570e-01],
          [ 1.0644e+00,  8.3920e-01,  2.5525e-01,  ...,  1.5439e-01,
           -4.7327e-02,  3.7333e-02],
          ...,
          [ 2.6605e-01, -2.2417e-01,  3.0616e-01,  ..., -8.8352e-01,
           -4.9551e-01,  5.0210e-01],
          [ 4.7008e-01,  2.5467e-01,  1.4456e-01,  ...,  1.0232e+00,
            1.0168e+00,  1.4345e+00],
          [ 7.3621e-01,  1.8390e-01, -7.5219e-01,  ...,  6.1048e-01,
           -8.9561e-02,  9.0824e-01]],

         [[ 6.6350e-01, -1.1343e-01, -7.6699e-02,  ...,  6.1778e-01,
            1.7660e-01, -3.4263e-01],
          [ 4.1517e-01, -5.5633e-01,  1.6895e-01,  ...,  1.5403e-01,
            3.1033e-01,  2.8814e-01],
          [ 2.8907e-02,  1.9650e-01,  5.4926e-02,  ...,  6.4456e-01,
            7.6700e-01, -3.0209e-02],
          ...,
          [ 1.6130e-01,  1.9631e-01,  6.5853e-01,  ...,  1.6015e-01,
            4.1996e-01,  3.7557e-01],
          [-1.1528e+00, -4.2700e-01,  1.1443e-01,  ..., -3.6407e-04,
            3.8915e-01,  7.7925e-01],
          [-1.4959e-01, -5.4982e-01,  4.3564e-01,  ..., -7.9569e-02,
           -8.9731e-03,  1.0086e+00]]],


        [[[-1.7595e-01,  7.4598e-01,  3.3672e-01,  ..., -1.5806e-01,
           -6.5814e-01, -5.6850e-01],
          [ 2.3037e-01,  4.2773e-01,  3.2551e-01,  ...,  3.5369e-02,
           -3.4461e-01, -3.3694e-01],
          [-5.1798e-01, -3.8903e-01,  2.9976e-01,  ..., -1.7634e-01,
           -5.1798e-01, -5.2545e-01],
          ...,
          [ 6.9684e-01, -1.2594e-02,  1.3719e-01,  ..., -4.1026e-01,
           -1.9324e-01, -2.9303e-02],
          [ 2.0737e-01,  3.8704e-01,  3.1784e-01,  ..., -5.9229e-01,
           -2.9291e-01,  3.4831e-01],
          [-2.8701e-01,  3.1037e-01,  7.7664e-01,  ...,  1.7088e-02,
            2.8954e-01,  2.7873e-01]],

         [[-5.2581e-01,  2.4078e-01,  1.9043e-02,  ...,  9.5452e-02,
           -3.2629e-01,  1.4614e-01],
          [-7.6252e-01,  6.6877e-01, -3.1646e-02,  ..., -4.4216e-01,
            3.3292e-01,  6.7551e-01],
          [-2.8260e-01, -3.5641e-02,  2.0207e-01,  ..., -1.0081e-01,
           -7.3606e-01, -8.6965e-01],
          ...,
          [-6.5606e-02, -1.7423e-01, -4.7287e-01,  ..., -5.2406e-01,
           -2.5738e-01, -4.5339e-01],
          [-4.1019e-01,  3.1569e-01, -4.1119e-01,  ..., -5.3205e-01,
           -6.3118e-01,  4.7525e-01],
          [-4.8261e-01,  1.8335e-01,  6.2232e-01,  ..., -7.1308e-01,
           -3.9421e-01,  3.9160e-01]],

         [[ 3.5213e-01, -7.2888e-01, -4.7861e-01,  ...,  7.1987e-01,
           -1.0835e-01,  7.3292e-01],
          [ 1.3924e+00, -3.6618e-01, -5.0128e-01,  ...,  4.0365e-01,
           -8.9810e-01,  1.6940e-01],
          [ 7.9703e-01,  8.6596e-03,  1.5292e-01,  ..., -8.9572e-02,
            2.6214e-01, -2.9222e-01],
          ...,
          [-3.1970e-01,  3.5053e-01,  7.7345e-01,  ..., -1.1266e+00,
           -6.0890e-01,  5.0142e-01],
          [-1.6376e-01,  3.0450e-01, -6.7819e-02,  ..., -8.9420e-01,
           -6.9728e-01,  1.3666e-01],
          [-9.6588e-03,  5.0440e-01,  7.9566e-01,  ...,  2.0764e-01,
            4.1235e-01, -2.0681e-01]],

         [[-2.6538e-01, -6.3046e-01, -2.4271e-01,  ..., -1.5913e-01,
           -3.5211e-01,  3.0215e-01],
          [-4.7553e-02, -1.8870e-01,  2.0103e-01,  ...,  4.5985e-01,
           -3.4660e-01,  6.3233e-02],
          [ 2.4853e-01, -1.3094e-01, -5.2481e-02,  ...,  9.1837e-01,
           -2.2891e-01, -2.5178e-01],
          ...,
          [ 1.4307e-01,  1.3617e-01,  5.5939e-02,  ...,  5.1406e-01,
            1.5490e-01, -8.9344e-02],
          [ 3.6149e-01, -6.9334e-01, -1.6938e-01,  ...,  1.3676e-01,
           -1.8121e-01, -3.9588e-01],
          [-1.6583e-01, -6.7087e-01,  5.4245e-01,  ...,  2.4400e-01,
            2.4025e-01,  3.1812e-01]],

         [[ 4.6945e-02, -6.0368e-01, -5.8539e-01,  ...,  4.9156e-02,
           -1.6631e-01,  6.8270e-01],
          [-1.1586e-01, -5.2891e-01, -5.2248e-01,  ..., -2.9857e-01,
           -5.5383e-01,  1.0399e+00],
          [ 4.4009e-01, -4.4529e-01,  2.8454e-02,  ..., -1.7455e-01,
           -6.1011e-01,  2.8573e-01],
          ...,
          [-4.0871e-01, -5.9162e-01, -1.6088e-01,  ..., -5.1744e-02,
            7.7978e-01,  8.6743e-02],
          [-3.5123e-01,  2.5251e-03, -1.4380e-01,  ...,  1.8523e-01,
           -2.2802e-01,  4.3165e-01],
          [-8.1613e-01, -1.1285e-01,  7.2390e-01,  ..., -7.3614e-01,
            1.3659e-01, -5.5062e-01]]],


        ...,


        [[[ 7.8310e-02, -1.7220e-01, -2.9032e-01,  ...,  1.0661e+00,
            5.6968e-01,  6.2291e-02],
          [-1.6718e-01, -7.4290e-01, -7.2861e-01,  ..., -1.1372e-01,
            6.4418e-01,  2.2537e-01],
          [-7.3966e-02, -2.7005e-01,  5.2742e-01,  ..., -7.0893e-01,
            3.2129e-01, -2.7063e-01],
          ...,
          [-9.0178e-02, -2.2335e-01, -4.0283e-01,  ...,  7.3798e-01,
            4.1085e-01, -2.2798e-01],
          [-1.1434e-02, -2.4072e-01,  4.8361e-01,  ..., -2.9784e-01,
            8.7134e-01, -2.2393e-01],
          [-1.2646e-01, -9.7990e-01, -6.3694e-01,  ..., -1.0044e+00,
           -2.6291e-01,  1.7577e-01]],

         [[-1.6347e-01, -3.6242e-01,  4.2313e-01,  ..., -2.1176e-01,
            8.7242e-02, -4.8043e-01],
          [-2.8457e-02, -5.4611e-01, -4.1573e-01,  ...,  2.3288e-01,
           -3.7478e-01, -2.8149e-01],
          [ 3.4336e-01,  1.7474e-01,  4.4361e-01,  ..., -6.5137e-01,
           -1.0493e-02,  1.2465e+00],
          ...,
          [-6.2356e-01,  1.6643e-01,  6.8872e-01,  ...,  1.2471e-01,
            5.7708e-01,  7.1035e-01],
          [-3.7053e-01,  4.6582e-01,  1.5233e-01,  ..., -2.9790e-01,
            5.7263e-01,  1.4345e-01],
          [-1.1827e-01,  5.6143e-01, -5.5499e-01,  ...,  3.5939e-01,
            3.1593e-01, -5.4630e-01]],

         [[ 4.1351e-03,  5.6685e-01,  3.0385e-01,  ...,  4.2631e-01,
            5.7507e-01, -2.9531e-01],
          [-1.6298e-01, -1.0577e+00, -7.6406e-01,  ...,  4.2138e-01,
            3.9750e-02, -1.4189e-01],
          [ 1.2564e+00,  4.9316e-01, -4.2105e-01,  ...,  2.2604e-01,
           -7.2926e-01,  9.3721e-02],
          ...,
          [-3.7914e-01,  3.8928e-02,  2.2933e-01,  ...,  1.4934e-01,
           -2.2439e-02,  3.1645e-01],
          [-2.7311e-01, -3.9585e-01,  5.8521e-01,  ...,  1.0970e+00,
           -3.6489e-01,  3.3453e-01],
          [ 1.5427e-01, -3.9612e-01,  6.1808e-01,  ...,  6.7671e-01,
           -4.1722e-01, -6.6680e-01]],

         [[-3.7053e-01, -1.5573e-01,  3.3594e-01,  ...,  9.0907e-01,
            4.7886e-01, -4.8773e-01],
          [-2.2413e-01,  1.3339e-01,  4.7396e-01,  ...,  1.8648e-01,
           -5.1815e-01, -8.9576e-02],
          [-2.8661e-01,  1.0222e+00,  7.4307e-01,  ...,  7.5349e-01,
            3.3573e-01, -2.1004e-01],
          ...,
          [-4.9222e-01, -1.8125e-01, -2.6252e-01,  ...,  3.6473e-01,
            6.1668e-01, -9.1344e-01],
          [-3.3929e-01,  6.9889e-02,  1.5952e-01,  ..., -2.1576e-01,
            6.4466e-01, -7.2070e-01],
          [-1.8513e-01, -9.1290e-03,  1.2073e-01,  ..., -3.4746e-01,
           -2.2229e-01,  5.9300e-01]],

         [[ 3.8170e-01, -3.3593e-01, -4.2550e-01,  ...,  1.1177e+00,
            3.6774e-01, -8.0261e-01],
          [ 7.4061e-01, -3.5696e-01, -3.7273e-01,  ...,  1.7666e-01,
           -1.3801e+00, -4.2914e-01],
          [ 7.2767e-01, -1.4484e-01,  1.4292e-02,  ...,  3.8759e-02,
           -7.4721e-01, -5.7311e-01],
          ...,
          [-9.7729e-02, -1.0440e-01, -1.1411e-01,  ...,  7.3758e-01,
            4.4620e-01, -3.1609e-02],
          [-5.4660e-02,  3.0991e-01, -3.9558e-01,  ...,  5.3032e-01,
           -1.7396e-01,  1.5341e-01],
          [ 2.0558e-01,  9.9622e-02,  5.3982e-01,  ..., -1.7234e-01,
            1.2368e-01, -2.8778e-02]]],


        [[[-1.1732e+00,  1.7664e-01,  4.2427e-01,  ..., -1.8450e-01,
            8.3970e-01, -9.4364e-01],
          [-2.1144e-01,  1.4435e-01, -1.3734e-02,  ..., -1.0623e+00,
            1.3453e+00,  1.7466e-01],
          [-6.2449e-01,  7.8562e-01, -1.2903e-01,  ...,  4.0882e-01,
            5.8751e-01, -2.4789e-01],
          ...,
          [ 6.5904e-02, -1.0665e-01,  6.7329e-01,  ..., -6.4014e-01,
           -8.3171e-01, -6.5183e-01],
          [ 2.5906e-01,  9.0151e-01,  1.0144e+00,  ..., -1.5280e-01,
            4.4666e-01,  6.0277e-01],
          [ 7.4421e-01,  8.4723e-01,  6.3803e-01,  ...,  7.3352e-01,
           -2.4532e-01,  3.9535e-01]],

         [[-2.3110e-01, -5.1816e-01, -5.8630e-01,  ...,  5.6559e-01,
            7.3286e-01,  3.8017e-01],
          [ 8.1440e-01, -3.5983e-01,  4.9494e-01,  ...,  4.0447e-01,
            1.0456e-01,  2.0983e-01],
          [-4.1931e-01, -2.2467e-01,  7.8424e-01,  ..., -3.8976e-02,
            3.2097e-01,  1.0199e+00],
          ...,
          [-1.3029e-01,  1.1712e-01,  7.1974e-01,  ...,  5.7146e-01,
            6.7976e-02, -3.8915e-01],
          [ 2.0760e-01,  7.3063e-01,  5.2454e-01,  ...,  2.2938e-01,
           -6.3038e-03,  9.1102e-01],
          [-3.3526e-01,  6.2759e-01,  2.5256e-01,  ...,  5.0639e-01,
            7.8452e-01,  1.0185e+00]],

         [[-2.3825e-01, -9.2449e-01, -1.4416e-01,  ..., -6.6229e-01,
           -7.7808e-01, -5.8137e-01],
          [ 8.7459e-03, -6.3633e-01,  6.8343e-01,  ..., -7.5111e-01,
            6.6541e-02,  1.1004e+00],
          [-4.6761e-01,  4.9101e-02,  2.5007e-01,  ...,  1.8315e-01,
            1.4056e-01, -4.4388e-01],
          ...,
          [ 4.3278e-01,  3.4294e-01, -2.8996e-01,  ...,  4.6059e-02,
            5.5547e-01, -1.9830e-01],
          [ 3.5917e-01, -2.8206e-01,  6.1269e-02,  ...,  8.4708e-01,
            2.4500e-01, -5.9983e-01],
          [ 2.7400e-01,  6.5666e-01,  3.8695e-01,  ..., -8.6264e-01,
           -8.0363e-01,  5.8024e-02]],

         [[ 1.3266e+00,  3.5251e-01,  2.3741e-01,  ...,  7.0187e-01,
            4.0927e-02,  1.5389e-01],
          [ 5.2922e-01,  2.3838e-01, -3.0708e-01,  ..., -6.2660e-01,
           -2.7666e-01,  4.1374e-01],
          [-4.3206e-01, -7.8782e-01, -2.7220e-01,  ...,  1.4362e-01,
            5.2477e-01,  3.4514e-01],
          ...,
          [-9.2191e-02,  8.5630e-01,  3.4805e-01,  ..., -6.5458e-03,
           -3.2704e-01, -2.1116e-01],
          [ 3.3429e-01,  6.2824e-01,  4.7264e-01,  ...,  1.8063e-01,
            5.1101e-01, -9.8740e-01],
          [ 8.8575e-01,  3.7595e-01,  2.4903e-01,  ..., -3.2006e-01,
            9.3265e-01, -5.3438e-02]],

         [[-4.9533e-01,  4.7290e-01,  1.0597e+00,  ...,  8.7575e-01,
            5.8494e-01, -2.2899e-01],
          [ 2.1672e-02,  1.4480e-01,  1.0312e+00,  ..., -9.2782e-01,
            1.1918e-01,  2.9050e-01],
          [ 9.8971e-01, -5.2821e-01, -4.4122e-01,  ..., -4.8634e-01,
            8.7136e-01,  5.7290e-01],
          ...,
          [-4.7430e-01,  1.1105e+00, -4.9571e-01,  ..., -3.1618e-01,
            2.1440e-01,  6.0540e-01],
          [ 6.8532e-01,  5.8590e-01,  7.4000e-01,  ...,  6.1250e-02,
           -6.0011e-01, -8.2706e-01],
          [-4.3281e-01, -5.3469e-02, -3.4237e-01,  ..., -7.5670e-01,
            3.8763e-01,  6.7003e-01]]],


        [[[-3.6643e-01, -2.0039e-01,  3.9810e-01,  ...,  4.5954e-02,
            4.0834e-01, -4.1642e-01],
          [ 1.5839e-02,  4.7360e-02,  5.6273e-01,  ..., -9.0368e-01,
           -2.0380e-01,  2.1721e-01],
          [ 7.3981e-01,  6.9805e-01, -1.8894e-02,  ..., -8.3341e-02,
           -7.0492e-01, -4.1622e-01],
          ...,
          [ 1.1128e+00,  9.4259e-01, -1.1065e-01,  ..., -3.8550e-01,
           -7.5511e-02,  2.6299e-01],
          [ 6.2417e-02, -7.4106e-02,  3.1358e-01,  ..., -6.4449e-01,
            2.6961e-01,  7.3259e-02],
          [-4.2806e-01, -1.0261e-02,  2.2624e-01,  ..., -1.6305e-01,
            1.9292e-01, -3.3470e-01]],

         [[ 8.2450e-02, -4.1255e-01, -3.5549e-01,  ...,  8.5240e-02,
            4.0171e-01,  2.2015e-01],
          [-1.8280e-01,  8.4479e-02, -3.5169e-01,  ...,  3.3096e-01,
            1.6461e-01, -1.2245e-01],
          [ 5.2445e-01,  1.7279e-02,  4.3747e-01,  ...,  4.1972e-01,
            8.6761e-02, -5.5442e-03],
          ...,
          [ 3.3528e-01, -2.4645e-01, -1.0520e-01,  ..., -5.9716e-01,
           -2.3935e-01, -1.7874e-01],
          [ 1.6334e-01, -9.4806e-02, -3.7071e-01,  ..., -3.3216e-01,
            4.5192e-01,  5.1887e-01],
          [-1.5180e-02, -5.3376e-01,  1.6132e-01,  ...,  5.1456e-01,
           -2.5070e-02,  4.6283e-01]],

         [[ 3.9268e-02, -2.7381e-01, -2.4134e-02,  ..., -1.5765e-01,
           -4.4041e-01, -3.0690e-01],
          [-9.5172e-02, -9.5457e-01,  2.6002e-01,  ..., -1.0150e+00,
           -4.7211e-01, -1.9027e-01],
          [ 4.8292e-02, -5.0821e-01, -5.6027e-01,  ..., -4.7836e-01,
            2.4405e-01, -9.6328e-02],
          ...,
          [ 4.2970e-02, -1.1253e-01, -6.4612e-01,  ...,  1.7417e-01,
            2.6511e-01,  2.2878e-01],
          [ 1.1586e-01,  1.3692e-01, -4.8114e-01,  ..., -5.9306e-02,
           -1.8241e-01,  1.3668e-01],
          [ 3.6854e-01,  2.1628e-01,  3.6762e-01,  ..., -1.0019e-02,
           -1.2595e-01,  2.3387e-01]],

         [[ 6.3228e-02, -2.9602e-01, -3.4917e-01,  ..., -9.5073e-02,
            1.6214e-01, -1.5680e-01],
          [-4.4575e-01, -2.4500e-01, -4.3913e-01,  ..., -7.6196e-01,
            1.8239e-01, -7.9058e-01],
          [-6.7921e-01, -2.0470e-01, -5.9635e-02,  ...,  2.4996e-01,
            1.4403e-01,  6.1086e-02],
          ...,
          [-6.1106e-01, -7.1056e-01, -5.7309e-01,  ...,  5.7006e-01,
            1.4442e-01,  1.0243e+00],
          [-1.2798e-01, -3.9376e-01,  7.7646e-01,  ...,  2.2445e-01,
           -5.2967e-01,  3.3368e-01],
          [ 6.6080e-01, -4.9852e-01, -8.6116e-02,  ...,  9.0419e-01,
            4.8439e-01, -2.0392e-01]],

         [[-5.9958e-01,  7.5873e-02, -2.1567e-01,  ...,  2.5169e-01,
            2.0996e-01, -8.4102e-02],
          [ 3.8829e-01,  2.3411e-01,  5.2199e-01,  ..., -4.1217e-01,
            1.6559e-02,  3.8771e-01],
          [-2.3905e-01,  3.1873e-01,  2.3739e-01,  ...,  4.7504e-01,
            3.8777e-02,  2.9980e-01],
          ...,
          [-7.1762e-01,  4.5591e-01,  1.1451e-01,  ...,  4.6209e-01,
            4.7349e-01,  7.7528e-01],
          [-2.0344e-02,  7.8919e-01,  4.5069e-01,  ..., -4.4269e-01,
            5.6166e-02,  6.0062e-01],
          [-2.8967e-01, -3.6792e-01, -3.3662e-01,  ...,  1.3152e-01,
            1.3210e-01,  3.8268e-01]]]], device='cuda:0')}
Traceback (most recent call last):
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/trainer.py", line 59, in <module>
    main_cli(run=True)
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/trainer.py", line 48, in main_cli
    cli = WrappedLightningCLI(
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 358, in __init__
    self._run_subcommand(self.subcommand)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 670, in _run_subcommand
    fn(**fn_kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/models/imgspecformer.py", line 106, in validation_step
    input = self.preprocess(batch["images"])
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/models/imgspecformer.py", line 128, in preprocess
    x = self._slice(x)
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/models/imgspecformer.py", line 158, in _slice
    if sections[-1].shape[1] < self.hparams.slice_section_length:
IndexError: list index out of range
Traceback (most recent call last):
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/trainer.py", line 59, in <module>
    main_cli(run=True)
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/trainer.py", line 48, in main_cli
    cli = WrappedLightningCLI(
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 358, in __init__
    self._run_subcommand(self.subcommand)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 670, in _run_subcommand
    fn(**fn_kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 608, in fit
    call._call_and_handle_interrupt(
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1112, in _run
    results = self._run_stage()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1191, in _run_stage
    self._run_train()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1204, in _run_train
    self._run_sanity_check()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1276, in _run_sanity_check
    val_loop.run()
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/dataloader/evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/epoch/evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/loops/epoch/evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 1494, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/zxs/.conda/envs/starllm2/lib/python3.10/site-packages/lightning/pytorch/strategies/strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/models/imgspecformer.py", line 106, in validation_step
    input = self.preprocess(batch["images"])
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/models/imgspecformer.py", line 128, in preprocess
    x = self._slice(x)
  File "/scratch/zxs/scripts/starllm/back2/AstroCLIP/astroclip/models/imgspecformer.py", line 158, in _slice
    if sections[-1].shape[1] < self.hparams.slice_section_length:
IndexError: list index out of range
wandb: - 0.010 MB of 0.010 MB uploadedwandb: \ 0.010 MB of 0.010 MB uploadedwandb: | 0.010 MB of 0.010 MB uploadedwandb: / 0.010 MB of 0.011 MB uploadedwandb: - 0.010 MB of 0.042 MB uploadedwandb: \ 0.042 MB of 0.042 MB uploadedwandb: üöÄ View run hardy-puddle-34 at: https://wandb.ai/xiaosheng_zhao/astroclip-spectrum/runs/k1nidkft
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/xiaosheng_zhao/astroclip-spectrum
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./astroclip/outputs/wandb/run-20240716_124958-k1nidkft/logs
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
